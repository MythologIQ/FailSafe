::: TRIBUNAL PROMPT (AGENT 2: CLAUDE) :::

**YOUR ROLE:** SECURITY_AUDITOR  
**DESCRIPTION:** Security expert specializing in governance systems, access control, cryptographic integrity, and threat modeling.

**INPUT:** Read the attached `SYSTEM_STATE.md` file.

**TASK:** 
Conduct a comprehensive security audit of the M-Core Governance Substrate implementation:

1. **Axiom Enforcement Security**
   - Evaluate the robustness of Drift detection (Axiom 1)
   - Assess the scope boundary validation (Axiom 2) for bypass vulnerabilities
   - Identify potential privilege escalation vectors in gate status enforcement (Axiom 3)
   - Analyze session recovery mechanisms for tampering risks (Axiom 4)

2. **Intent Immutability & Integrity**
   - Evaluate the SEALED status enforcement for circumvention risks
   - Assess whether JSONL append-only log is sufficient or requires cryptographic signing
   - Identify race conditions in Intent creation/modification
   - Recommend cryptographic improvements (e.g., Merkle chain integration)

3. **File System Security**
   - Analyze path normalization logic for directory traversal vulnerabilities
   - Evaluate scope wildcard handling (if implemented) for bypass risks
   - Assess file write hook security for TOCTOU (Time-of-Check-Time-of-Use) attacks
   - Identify potential symlink or junction-based attacks

4. **Access Control & Authorization**
   - Evaluate the Integration Contract for enforcement gaps
   - Assess whether execution systems can bypass EnforcementEngine
   - Identify missing authorization checks (e.g., who can create/seal Intents?)
   - Recommend role-based access control (RBAC) if needed

5. **Threat Modeling**
   - Identify high-risk attack vectors (e.g., malicious agent, compromised workspace)
   - Assess defense-in-depth mechanisms
   - Recommend security hardening priorities

6. **Privacy & Compliance**
   - Evaluate Intent history logging for PII leakage risks
   - Assess compliance with data retention policies
   - Recommend sanitization strategies for sensitive data

---

## ðŸ›‘ REQUIRED OUTPUT PROTOCOL (NON-NEGOTIABLE)

REGARDLESS of your task outcome (Success, Failure, or Partial), you **MUST** generate a completion report.

1. **Target File:** `.agent/staging/responses/AGENT_2_CLAUDE.md`
2. **Content Requirements:**
   - **Header:** `# REPORT: AGENT 2 (SECURITY_AUDITOR)`
   - **Summary:** Executive summary of security posture
   - **Deliverables:** Detailed analysis per section above
   - **Vulnerabilities:** Prioritized list (CRITICAL / HIGH / MEDIUM / LOW)
   - **Recommendations:** Security hardening roadmap
   - **Status:** [COMPLETE / PARTIAL / FAILED]

**FAILURE TO WRITE THIS FILE IS CONSIDERED A TOTAL FAILURE OF THE TASK.**  
If you write code but do not write this report, your work will be discarded.
